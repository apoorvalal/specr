---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  fig.retina = 2
)
```


<div style = "padding-top:1em; padding-bottom: 0.5em;">
<img src="man/figures/specr_logo.png" width = 125 align="right" />
</div>


# specr

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/specr)](https://CRAN.R-project.org/package=specr)
<!-- badges: end -->

The goal of specr is to facilitate specification curve analyses as described by Simonson, Simmons & Nelson (2019).[^1] It provides functions to setup, run, and plot all specifications. 

**Disclaimer:** Running a specification curve analysis does not make your findings any more reliable, valid or generalizable than a single analyis. The method is meant to inform about the effects of analytical choices on results, and not a better way to estimate a correlation or effect.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("masurp/specr")
```

## Example

This is a basic example of how to use the major functions in this package. In a first step, check the data (here a simulated data set).

```{r, message=F, warning = F}
# Load library
library(specr)
head(example_data)
```

In a second step, we only need to use the function `run_specs()` and include our analytical choices as arguments. 
The resulting data frame includes relevant statistics of all models that were estimated.

```{r, message=F, warning = F}
# Self-made functions can be used too
mymodel <- function(formula, data) {
  glm(formula = formula, data = data, family = gaussian(link = "identity"))
}

# Run specification curve analysis
results <- run_specs(df = example_data, 
                     y = c("y1", "y2"), 
                     x = c("x1", "x2"), 
                     model = c("lm", "mymodel"), 
                     controls = c("c1", "c2"), 
                     subset = list(group1 = unique(example_data$group1),
                                   group2 = unique(example_data$group2)))
# Check results
results
```

In a final step, we can use the function `plot_specs()` to produce a typical visualization of the specification curve and how the analytical choices affected the obtained results. 


```{r, fig.height=10, fig.width=10, message=F, warning = F}
# Plot specification curve analysis
plot_specs(results)
```

Furthermore, we can estimate how much variance in the specification curve is related to which analytical decisions. Therefore, we can use the function `variance_specs()` to calculate a respective table or `plot_variance()`to visualize the distribution.

```{r, fig.height=3.5, fig.width=8, message=F, warning = F}
# Decompose variance of the specification curve
variance_specs(results)

# Plot decomposition
plot_variance(results)
```


## How to cite this package

Developing and maintaining open source software is an important yet often underappreciated contribution to scientific progress. Thus, whenever you are using open source software (or software in general), please make sure to cite it appropriately so that developers get credit for their work.

When using `specr`, please cite it as follows:

```{r}
citation("specr")
```

## References

[^1]: Simonsohn, U., Simmons, J. P., & Nelson, L. D. (2019). Specification Curve: Descriptive and Inferential Statistics for all Plausible Specifications Available at: http://urisohn.com/sohn_files/wp/wordpress/wp-content/uploads/Paper-Specification-curve-2019-11-16.pdf
